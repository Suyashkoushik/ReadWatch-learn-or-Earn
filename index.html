<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Earning Website</title>
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <style>
        /* CSS Styles */
        body {
            background-color: #111; /* Dark theme background */
            color: #00ffff; /* Neon blue color */
            position: relative;
            font-family: Arial, sans-serif;
            overflow: hidden;
        }

        .w3-navbar {
            background: rgba(0, 0, 0, 0.7); /* Transparent navigation bar */
        }

        .neon-text {
            color: #00ffff; /* Neon blue text color */
            text-shadow: 0 0 5px #00ffff, 0 0 10px #00ffff, 0 0 15px #00ffff;
        }

        .popup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #222;
            color: #00ffff;
            padding: 20px;
            border: 2px solid #00ffff;
            z-index: 10;
            max-width: 400px;
            width: 90%;
        }

        #earning-options {
            display: none; /* Hide earning options before login */
        }

        .w3-hover-neon:hover {
            background-color: #00ffff !important;
            color: #111 !important;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="w3-center w3-padding-16">
        <h1 class="neon-text">Welcome</h1>
        <div id="user-coins" style="display: none;">Coins: <span id="coins-count">0</span></div>
    </header>

    <!-- Navigation bar -->
    <div class="w3-bar w3-navbar">
        <button class="w3-bar-item w3-button w3-right w3-hover-neon" onclick="openPopup('login-popup')" id="login-btn">Login</button>
        <button class="w3-bar-item w3-button w3-right w3-hover-neon" onclick="openPopup('signup-popup')" id="signup-btn">Sign Up</button>
        <button class="w3-bar-item w3-button w3-right w3-hover-neon" id="logout-btn" style="display: none;" onclick="logoutUser()">Logout</button>
        <button class="w3-bar-item w3-button w3-right w3-hover-neon" id="profile-btn" style="display: none;" onclick="openPopup('profile-popup')">Profile</button>
    </div>

    <!-- Main section before login -->
    <div class="w3-container w3-padding-16" id="before-login">
        <h2 class="neon-text">How to Earn</h2>
        <p class="neon-text">Join us and start earning by sharing your referral code, checking in daily, spinning the wheel, reading content, watching videos, and more. Sign up now to get started!</p>
    </div>

    <!-- Earning options (only visible after login) -->
    <div class="w3-container w3-padding-16" id="earning-options">
        <h2 class="neon-text">Earning Options</h2>
        <button class="w3-button w3-neon w3-margin" onclick="openPopup('referral-popup')">Share Referral Code</button>
        <button class="w3-button w3-neon w3-margin" onclick="window.location.href='daily-checkin.html'">Daily Check-In</button>
        <button class="w3-button w3-neon w3-margin" onclick="window.location.href='spin-to-earn.html'">Spin to Earn</button>
        <button class="w3-button w3-neon w3-margin" onclick="window.location.href='read-and-earn.html'">Read and Earn</button>
        <button class="w3-button w3-neon w3-margin" onclick="window.location.href='watch-and-earn.html'">Watch and Earn</button>
        <button class="w3-button w3-neon w3-margin" id="withdraw-btn" style="display: none;" onclick="window.location.href='withdraw.html'">Withdraw</button>
    </div>

    <!-- Login Popup -->
    <div id="login-popup" class="popup">
        <h3 class="neon-text">Login</h3>
        <input class="w3-input w3-margin-bottom" type="email" id="login-email" placeholder="Email" required>
        <input class="w3-input w3-margin-bottom" type="password" id="login-password" placeholder="Password" required>
        <button class="w3-button w3-neon" onclick="loginUser()">Login</button>
        <button class="w3-button w3-neon" onclick="openPopup('forgot-password-popup')">Forgot Password?</button>
        <button onclick="closePopup('login-popup')" class="w3-button w3-neon">Close</button>
    </div>

    <!-- Forgot Password Popup -->
    <div id="forgot-password-popup" class="popup">
        <h3 class="neon-text">Forgot Password</h3>
        <input class="w3-input w3-margin-bottom" type="email" id="forgot-password-email" placeholder="Enter your email" required>
        <button class="w3-button w3-neon" onclick="sendPasswordReset()">Send Reset Email</button>
        <button onclick="closePopup('forgot-password-popup')" class="w3-button w3-neon">Close</button>
    </div>

    <!-- Sign Up Popup -->
    <div id="signup-popup" class="popup">
        <h3 class="neon-text">Sign Up</h3>
        <input class="w3-input w3-margin-bottom" type="email" id="signup-email" placeholder="Email" required>
        <input class="w3-input w3-margin-bottom" type="password" id="signup-password" placeholder="Password" required>
        <input class="w3-input w3-margin-bottom" type="text" id="referral-code" placeholder="Enter a Referral Code (optional)">
        <button class="w3-button w3-neon" onclick="signUpUser()">Sign Up</button>
        <button onclick="closePopup('signup-popup')" class="w3-button w3-neon">Close</button>
    </div>

    <!-- Profile Popup -->
    <div id="profile-popup" class="popup">
        <p>Email: <span id="user-email"></span></p>
        <p>Coins: <span id="popup-coins-count">0</span></p>
        <button id="referral-history-btn" class="w3-button w3-neon">Referral History</button>
        <button id="verify-email-btn" class="w3-button w3-neon">Verify Email</button>
        <button id="enter-referral-btn" class="w3-button w3-neon">Enter Referral Code</button>
        <button onclick="closePopup('profile-popup')" class="w3-button w3-neon">Close</button>
    </div>

    <!-- Referral Popup -->
    <div id="referral-popup" class="popup">
        <p>Share your referral code:</p>
        <p>Website URL: <input type="text" value="https://yourwebsite.com/?ref=12345" readonly></p>
        <button onclick="closePopup('referral-popup')" class="w3-button w3-neon">Close</button>
    </div>

    <script type="module">
        // JavaScript code to handle Firebase authentication and user actions
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged, sendEmailVerification, sendPasswordResetEmail } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCo-22CK4Dg3xxzMHhC8bT9h_54DTSQjfI",
            authDomain: "earn-by-reading-news-fdb97.firebaseapp.com",
            projectId: "earn-by-reading-news-fdb97",
            storageBucket: "earn-by-reading-news-fdb97.appspot.com",
            messagingSenderId: "557093188815",
            appId: "1:557093188815:web:6fb3c6325e7cf39d73b3ba"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // Function to handle user login
        window.loginUser = function() {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            signInWithEmailAndPassword(auth, email, password)
                .then(() => {
                    alert('Login successful!');
                    closePopup('login-popup');
                    document.getElementById('earning-options').style.display = 'block'; // Show earning options
                    document.getElementById('before-login').style.display = 'none'; // Hide before-login section
                })
                .catch((error) => {
                    alert(error.message);
                });
        };

        // Function to handle user sign up
        window.signUpUser = function() {
            const email = document.getElementById('signup-email').value;
            const password = document.getElementById('signup-password').value;
            const referralCode = document.getElementById('referral-code').value;

            createUserWithEmailAndPassword(auth, email, password)
                .then((userCredential) => {
                    alert('Sign up successful!');
                    closePopup('signup-popup');
                    // You can also save the user data to Firestore here if needed
                })
                .catch((error) => {
                    alert(error.message);
                });
        };

        // Function to handle user logout
        window.logoutUser = function() {
            signOut(auth).then(() => {
                alert('Logout successful!');
                document.getElementById('earning-options').style.display = 'none'; // Hide earning options
                document.getElementById('before-login').style.display = 'block'; // Show before-login section
            }).catch((error) => {
                alert(error.message);
            });
        };

        // Function to open popups
        window.openPopup = function(popupId) {
            document.getElementById(popupId).style.display = 'block';
        };

        // Function to close popups
        window.closePopup = function(popupId) {
            document.getElementById(popupId).style.display = 'none';
        };

        // Function to send password reset email
        window.sendPasswordReset = function() {
            const email = document.getElementById('forgot-password-email').value;
            sendPasswordResetEmail(auth, email)
                .then(() => {
                    alert('Password reset email sent! Check your inbox.');
                    closePopup('forgot-password-popup');
                })
                .catch((error) => {
                    alert(error.message);
                });
        };

        // Auth state observer
        onAuthStateChanged(auth, (user) => {
            if (user) {
                // User is signed in, update UI
                document.getElementById('user-email').textContent = user.email;
                document.getElementById('coins-count').textContent = "Loading..."; // Replace with actual coins count logic
                document.getElementById('popup-coins-count').textContent = "Loading..."; // Replace with actual coins count logic
                document.getElementById('logout-btn').style.display = 'block'; // Show logout button
                document.getElementById('profile-btn').style.display = 'block'; // Show profile button
            } else {
                // User is signed out, reset UI
                document.getElementById('coins-count').textContent = '0';
                document.getElementById('popup-coins-count').textContent = '0';
                document.getElementById('logout-btn').style.display = 'none'; // Hide logout button
                document.getElementById('profile-btn').style.display = 'none'; // Hide profile button
            }
        });
    </script>
</body>
</html>
